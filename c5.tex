\documentclass{article} % Polska wersja klasy article

\usepackage{polski} % Pozwala na użycie polskiego. Ustawia między innymi fontenc na T1
\usepackage[utf8]{inputenc} % Informuje o kodowaniu
\usepackage{textcomp} % Znaki specjalne takie jak ~
\usepackage{xcolor} % Definicje kolorów
\usepackage{tcolorbox} % Ładne ramki

\renewcommand{\labelitemi}{\textbullet} % Zmiana symbolu wliczeń

\usepackage{graphicx}
\graphicspath{ {./Obrazy/} }
\usepackage{subcaption} % Subfigury
\usepackage{float} % Pozycjonowanie figur
\usepackage{mwe} % Tymczasowe grafiki

\usepackage{listings} % Listingi kodu
\lstset{basicstyle=\ttfamily,
  showstringspaces=false,
  commentstyle=\color{gray},
  keywordstyle=\color{blue}
}

\newcommand{\paragraphnl}[1]{\paragraph{#1} \mbox{} \\} % Paragraf z nową linią

\title{Laboratorium sieci komputerowych - c5 \\ Montowanie dysków sieciowych}
\author{Krzysztof Dąbrowski gr. 3}
\date{\today}

\begin{document}
\maketitle{}
\tableofcontents{}
%\newpage

\section{Cel zajęć}
Celem laboratorium c5 jest badanie udostępnionych dysków sieciowych i ich montowanie.
Przerabiane jest również instalowanie i konfiguracja serwerów SMB i NFS.

\section{Instalacja serwera SMB}
Chciałem uruchomić mój własny serwer SMB. W tym celu zainstalowałem serwer smb na stacji roboczej pod systemem Ubuntu.

\begin{verbatim}
  sudo apt install samba
\end{verbatim}

W celu sprawdzenie czy instalacja przebiegła pomyślnie skorzystałem z polecenia \texttt{whereis}.
\begin{verbatim}
  whereis samba

  samba: /usr/sbin/samba /usr/lib/samba /etc/samba /usr/share/samba /usr/share/man/man7/samba.7.gz /usr/share/man/man8/samba.8.gz
\end{verbatim}

Utworzyłem katalog, który będę udostępniał poleceniem \texttt{mkdir publicznyKatalog} oraz umieściłem w nim plik tekstowy.

\paragraph{Ustawienie konfiguracji} \mbox{} \\
Do pliku konfiguracyjnego dodałem ustawienie udostępniające katalog.

\begin{tcolorbox}[colback=yellow!10!white,colframe=red!45!black,coltitle=yellow!100!black, title=Konfiguracja serwera SMB]
  \begin{lstlisting}
  /etc/samba/smb.conf
  \end{lstlisting}
  \tcblower
  \footnotesize
  \begin{lstlisting}
  .
  .
  .

  [sambashare]
    comment = Samba on Ubuntu
    path = /home/username/sambashare
    read only = no
    browsable = yes 
  \end{lstlisting}
\end{tcolorbox}
\normalsize

\paragraph{Uruchomienie serwera SMB} \mbox{} \\
Uruchomiłem serwer SMB poleceniem \texttt{sudo service smbd restart}

By sprawdzić czy serwer działa wykonałem \texttt{sudo systemctl status smbd}
\begin{verbatim}
  sudo systemctl status smbd

  smbd.service - LSB: start Samba SMB/CIFS daemon (smbd)
   Loaded: loaded (/etc/init.d/smbd; bad; vendor preset: enabled)
   Active: active (running) since pon 2019-05-27 17:05:10 CEST; 11s ago
  ...
\end{verbatim}

Następnie ustawiłem hasło do zasobów serwera \texttt{sudo smbpasswd -a dabrowk1}

By sprawdzić czy zasób jest udostępniany uruchomiłem \texttt{smbclient -L s6}
\begin{verbatim}
  smbclient -L s6  

  WARNING: The "syslog" option is deprecated
  Enter dabrowk1's password: 
  Domain=[WORKGROUP] OS=[Windows 6.1] Server=[Samba 4.3.11-Ubuntu]

	Sharename       Type      Comment
	---------       ----      -------
	print$          Disk      Printer Drivers
	sambashare      Disk      Samba na Ubuntu S6
	IPC$            IPC       IPC Service (s6 server (Samba, Ubuntu))
	SK102           Printer   HP LaserJet M402dn
\end{verbatim}

\section{Windows}
Obsługę dysków sieciowych na systemie Windows wykonałem na maszynie Wat przy pomocy zdalnego pulpitu.

\subsection{SMB}

\subsubsection{Przeglądanie zasobów}
By zobaczyć zasoby udostępnione na stacji użyłem \texttt{net view s6}.

\begin{tcolorbox}[colback=yellow!10!white,colframe=red!45!black,coltitle=yellow!100!black, title=Windows]
  \begin{lstlisting}
  net view s6
  \end{lstlisting}
  \tcblower
  \footnotesize
  \begin{lstlisting}
  Shared resources at s6
  
  s6 server (Samba, Ubuntu)

  Share name  Type   Used as  Comment

  --------------------------------------------------------------
  sambashare  Disk            Samba na Ubuntu S6
  SK102       Print           HP LaserJet M402dn
  The command completed successfully.
  \end{lstlisting}
\end{tcolorbox}
\normalsize

\subsubsection{Montowanie zasobów}
Sprawdziłem zamontowane zasoby poleceniem \texttt{net use}.

\begin{tcolorbox}[colback=yellow!10!white,colframe=red!45!black,coltitle=yellow!100!black, title=Windows]
  \begin{lstlisting}
  net use
  \end{lstlisting}
  \tcblower
  \footnotesize
  \begin{lstlisting}
  New connections will not be remembered.


  Status       Local     Remote                    Network
  
  -----------------------------------------------------------
  OK           H:        \\stud\dabrowk1           Microsoft Windows Network
  The command completed successfully.
  \end{lstlisting}
\end{tcolorbox}
\normalsize
\vspace{5mm}

Następnie połączyłem dysk ze stacji \texttt{c6} poleceniem \texttt{net use :Z \textbackslash{}\textbackslash{}s6\textbackslash{}smbashare}.

By zobaczyć czy dysk jest zamontowany ponownie wykonałem \texttt{net use}.
\begin{tcolorbox}[colback=yellow!10!white,colframe=red!45!black,coltitle=yellow!100!black, title=Windows]
  \begin{lstlisting}
  net use
  \end{lstlisting}
  \tcblower
  \footnotesize
  \begin{lstlisting}
    New connections will not be remembered.


    Status       Local     Remote                    Network
    
    -----------------------------------------------------------
    OK           H:        \\stud\dabrowk1           Microsoft Windows Network
    OK           Z:        \\s6\sambashare           Microsoft Windows Network
    The command completed successfully.
  \end{lstlisting}
\end{tcolorbox}
\normalsize
\vspace{5mm}

By domontować dysk po zakończonej pracy wpisałem \texttt{net use Z: /delete}.

\subsection{NFS}

\subsubsection{Przeglądanie zasobów}
By zobaczyć zasoby nfs serwara volt uruchomiłem \texttt{showmount -e volt}.
\begin{tcolorbox}[colback=yellow!10!white,colframe=red!45!black,coltitle=yellow!100!black, title=Windows]
  \begin{lstlisting}
  showmount -e volt
  \end{lstlisting}
  \tcblower
  \footnotesize
  \begin{lstlisting}
    Exports list on volt:
    /tmp/obj                           All Machines
    /home/stud                         ldap, fed.iem.pw.edu.pl, ...
    /nfs                               lap
  \end{lstlisting}
\end{tcolorbox}
\normalsize

\subsubsection{Montowanie zasobów}
By zamontować katalog udostępniany przez serwer wykonałem \texttt{mount \\volt\ I:}
\begin{tcolorbox}[colback=yellow!10!white,colframe=red!45!black,coltitle=yellow!100!black, title=Windows]
  \begin{lstlisting}
  mount \\volt\ I:
  \end{lstlisting}
  \tcblower
  \footnotesize
  \begin{lstlisting}
  I: is now successfully connected to \\volt\

  The command completed successfully.
  \end{lstlisting}
\end{tcolorbox}
\normalsize
\vspace{5mm}

By sprawdzić czy zasób jest poprawnie zamontowany wykonałem \texttt{mount} bez argumentów.
\begin{tcolorbox}[colback=yellow!10!white,colframe=red!45!black,coltitle=yellow!100!black, title=Windows]
  \begin{lstlisting}
  mount
  \end{lstlisting}
  \tcblower
  \footnotesize
  \begin{lstlisting}
  Local    Remote
  ----------------
  I:       \\volt\
  \end{lstlisting}
\end{tcolorbox}
\normalsize
\vspace{5mm}

Na koniec odłączyłem dysk poleceniem \texttt{umount I:}.

\section{Ubuntu}
Ćwiczenie wykonałem na stacji laboratoryjne c6, na której wcześniej postawiłem serwer SMB.

\subsection{SMB}

\subsubsection{Przeglądanie zasobów}
W celu zobaczenia zasobów na stacji uruchomiłem \texttt{smbclient -L s6}
\begin{tcolorbox}[colback=yellow!10!white,colframe=red!45!black,coltitle=yellow!100!black, title=Ubuntu]
  \begin{lstlisting}
    smbclient -L s6
  \end{lstlisting}
  \tcblower
  \footnotesize
  \begin{lstlisting}
    Sharename       Type      Comment
    ---------       ----      -------
    print$          Disk      Printer Drivers
    sambashare      Disk      Samba na Ubuntu S6
    SK102           Printer   HP LaserJet M402dn
  \end{lstlisting}
\end{tcolorbox}
\normalsize

\subsubsection{Montowanie zasobów}
Zamontowałem utworzony wcześniej zasób poleceniem \texttt{sudo mount -t cifs -o user=dabrowk1 //s6/sambashare punktMontowania}.

W celu sprawdzenia poprawności montowania spróbowałem wypisać zawartość zamontowanego katalogu.
\begin{tcolorbox}[colback=yellow!10!white,colframe=red!45!black,coltitle=yellow!100!black, title=Ubuntu]
  \begin{lstlisting}
  ls punktMontowania
  \end{lstlisting}
  \tcblower
  \footnotesize
  \begin{lstlisting}
  plik1.txt
  \end{lstlisting}
\end{tcolorbox}
\normalsize

\subsection{NFS}

\subsubsection{Przeglądanie zasobów}


\section{TMP}

\subsection{Montowanie zasobu SMB}
\paragraph{Ubuntu} \mbox{} \\
Zamontowałem utworzony wcześniej zasób poleceniem \texttt{sudo mount -t cifs -o user=dabrowk1 //s6/sambashare punktMontowania}.

By sprawdzić czy montowanie się powiodło wyświetliłem zawartość katalogu.
\begin{verbatim}
  ls punktMontowania 

  plik1.txt
\end{verbatim}

\paragraph{Windows} \mbox{} \\
Zbadałem jakie dyski są zamontowane poleceniem \texttt{net use}.
\begin{verbatim}
  PS H:\> net use
  New connections will not be remembered.


  Status       Local     Remote                    Network

  -------------------------------------------------------------------------------
  OK           H:        \\stud\dabrowk1           Microsoft Windows Network
  The command completed successfully.
\end{verbatim}
Jedyny podłączony dysk to H

Następnie montuję dysk poleceniem \texttt{net use Z: \\\\s6\\sambashare}.
By sprawdzić czy dysk został zamontowany ponownie wywołałem \texttt{net use}.
\begin{verbatim}
  net use
  New connections will not be remembered.


  Status       Local     Remote                    Network

  -------------------------------------------------------------------------------
  OK           H:        \\stud\dabrowk1           Microsoft Windows Network
  OK           Z:        \\s6\sambashare           Microsoft Windows Network
  The command completed successfully.
\end{verbatim}

Po zakończonej pracy odmontowałem dysk poleceniem \texttt{net use Z: /delete}

\section{FreeBSD}
Zadanie realizowałem na maszynie laboratoryjnej \texttt{se}.

\subsection{Oglądanie eksportowanych zasobów}
Sprawdziełem dyski SMB eksportuje serwer \texttt{volt} poleceniem \texttt{showmount}.

\begin{tcolorbox}[colback=yellow!10!white,colframe=red!45!black,coltitle=yellow!100!black, title=FreeBSD]
  \begin{lstlisting}
  showmount -e volt -t cifs
  \end{lstlisting}
  \tcblower
  \tiny
  \begin{lstlisting}
    Exports list on volt:
  /tmp/obj                           Everyone
  /home/stud                         ldap fed.iem.pw.edu.pl ...
  /                                  Everyone
  /nfs                               lap
  \end{lstlisting}
\end{tcolorbox}
\normalsize

\vspace{1cm}
Oraz jakie dyski NFS eksportuje serwer \texttt{ldap}.
\begin{tcolorbox}[colback=yellow!10!white,colframe=red!45!black,coltitle=yellow!100!black, title=FreeBSD]
  \begin{lstlisting}
  showmount -e ldap -t nfs
  \end{lstlisting}
  \tcblower
  \tiny
  \begin{lstlisting}
    Exports list on ldap:
    /                                  Everyone
    /nfs/arch2                         s2.iem.pw.edu.pl pxe.iem.pw.edu.pl k0.iem.pw.edu.pl  
    /home/stud2                        Everyone
  \end{lstlisting}
\end{tcolorbox}
\normalsize

\subsection{Montowanie udziałów}
Utworzyłem katalog będący punktem montowania poleceniem \texttt{mkdir mountingPoint}.

\subsection{SMB}
\begin{verbatim}
  root@se:~ # mount -t cifs -o user=dabrowk1 //volt/pub/ mountingPoint/mount: /volt/pub: Operation not supported by device 
\end{verbatim}

\subsection{NFS}
Zamontowałem dysk poleceniem \texttt{mount -t nfs ldap:/ mountingPoint}. Następnie sprawdziłem czy dysk jest zamontowany poleceniem \texttt{df -h}.

\begin{tcolorbox}[colback=yellow!10!white,colframe=red!45!black,coltitle=yellow!100!black, title=FreeBSD]
  \begin{lstlisting}
  df -h
  \end{lstlisting}
  \tcblower
  \tiny
  \begin{lstlisting}
    Filesystem    Size    Used   Avail Capacity  Mounted on
    /dev/md0      274M    147M    105M    58%    /
    devfs         1.0K    1.0K      0B   100%    /dev
    tmpfs         2.3G     16K    2.3G     0%    /tmp
    tmpfs         2.3G     12M    2.3G     1%    /var
    ldap:/R        58G     30G     27G    53%    /net/ldap
    ldap:/         58G     30G     27G    53%    /root/mountingPoint 
  \end{lstlisting}
\end{tcolorbox}
\normalsize

Następnie odmontowałem dysk poleceniem \texttt{umount mountingPoint}.

\end{document}